<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="//font.elice.io/EliceDigitalBaeum.css" rel="stylesheet">
    <link href="/assets/css/fix/footer.css" rel="stylesheet" type="text/css">
    <link href="/assets/css/fix/header.css" rel="stylesheet" type="text/css">
    <link href="/assets/css/mypage/payment.css" rel="stylesheet" type="text/css">
    <title>결제</title>
</head>
<body>
<!-- 헤더 시작 -->

<th:block th:insert="/fix/headerWord.html :: headFragment"/>

<!--헤더 이미지-->
<div id="headerImgWrap" >
    <img id="headerImg"src="/images/fix/headerImg_3.png" >
</div>
<!-- 헤더 종료 -->
<div id="qwer">
    <div id="allWrap" style=" margin:0 auto; padding-top: 20px; padding-bottom: 100px; zoom: 1.2;">
        <div class="profileWrap1">
            <div class="group">
                <div class="left_block">
                    <ul class="liWrap">
                        <li class="li_top left">
                            <a class="menu" href="javascript:goEditProfile();">프로필 수정</a>
                        </li>
                        <li class="left">
                            <a class="menu" href="javascript:goMyWork();">내 작품 관리</a>
                        </li>
                        <li class="left">
                            <a class="menu" href="javascript:goChangePw();">비밀번호 변경</a>
                        </li>
                        <li class="left">
                            <a class="menu" href="javascript:goQuestion();">내 문의 내역</a>
                        </li>
                        <li class="left">
                            <a class="menu" href="javascript:goQuit();">탈퇴 하기</a>
                        </li>
                        <li class="left">
                            <a class="menu" href="javascript:goPayList();">결제</a>
                        </li>
                    </ul>
                </div>
                <div class="right_block">
                    <div class="">
                        <div class="profile_text"><strong>최근 구매/후원 내역 </strong></div>
                        <table class="listWrap">
                            <tbody>
                            <tr>
                                <td class="active1 one" style="width: 50%">
                                    <div class="active myPoint">내 포인트</div>
                                </td>
                                <td class="active2" style="width: 50%">
                                    <div class="active mySupport"> 내 후원 내역</div>
                                </td>
                            </tr>
                            </tbody>
                        </table>

                        <div class="payTableWrap">
                            <th:block th:if="${payDTO != null}">
                            <div class="paymentWrap">
                                <div th:text="'총 결제 금액 :' + ${payDTO.chargeTotal} + '원'">총 결제 금액</div>
                                <div>
                                    <form>
                                        <div id="dateType" >
                                            <input type="date" id="dateFrom" name="startDate">
                                            ~ <input type="date" id="dateTo" name="endDate">
                                        </div>
                                        <div class="searchWrap">
                                            <button class="btn btn-sm" id="btnSearch" name="btnSearch">검색</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            </th:block>
                            <table class="pointTable">
                                <tbody>
                                <tr>
                                    <th>결제 금액</th>
                                    <th>결제 일</th>
                                </tr>
                                <th:block th:each="pay:${payList}">
                                    <tr>
                                        <td class="td1" th:text="|${pay.getPayCharge()}원|"></td>
                                        <td class="td1" th:text="*{#dates.format(pay.getPayDate(), 'yyyy-MM-dd')}"></td>
                                    </tr>
                                </th:block>
                                </tbody>
                            </table>
                        </div>

                        <div class="payTableWrap2">
                            <div class="paymentWrap">
                                <div>총 후원 금액 (금액)원</div>
                                <div>
                                    <form>
                                        <div id="dateType" >
                                            <input type="date" id="dateFrom" name="form">
                                            ~ <input type="date" id="dateTo" name="to">
                                        </div>
                                        <div class="searchWrap">
                                            <button class="btn btn-sm" id="btnSearch" name="btnSearch">검색</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <table class="pointTable">
                                <tbody>
                                <tr>
                                    <th>후원 금액</th>
                                    <th>후원한 날짜</th>
                                </tr>
                                <tr>
                                    <td class="td1">20,000 원</td>
                                    <td class="td1">2022-05-02</td>
                                </tr>
                                <tr>
                                    <td class="td1">50,000 원</td>
                                    <td class="td1">2022-05-01</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <!--페이징-->
                        <div class=" d-flex align-items-center justify-content-center" style="height:80px;">
                            <nav aria-label="Page navigation">
                                <ul th:object="${pageDTO}" class="pagination pagination-basic pagination-primary mg-b-0">


                                    <!--                                        <li class="page-item" style="width:30px;margin-left:3px;">-->
                                    <!--                                            <a style="width:30px;opacity:0.4;" class="page-link" href="/freestory/all/date/1/all/?main_genre=">-->
                                    <!--                                                <i class="icon ion-arrow-left-a"></i>-->
                                    <!--                                            </a>-->
                                    <!--                                        </li>-->

                                    <!--                                        <li class="page-item" style="width:30px;margin-left:1px;">-->
                                    <!--                                            <a style="width:30px;opacity:0.4;" class="page-link" href="/freestory/all/date/1/all/?main_genre=">-->
                                    <!--                                                <i class="icon ion-arrow-left-b"></i>-->
                                    <!--                                            </a>-->
                                    <!--                                        </li>-->
                                    <!--이전 버튼-->
                                    <li><a class="page-link" th:if="*{prev}" th:href="*{startPage - 1}">&lt;</a></li>

                                    <!--페이지 번호-->
                                    <th:block th:each="num:${#numbers.sequence(pageDTO.getStartPage(), pageDTO.getEndPage())}">
                                        <li th:if="${pageDTO.criteria.getPageNum() == num}" th:text="${num}" class="page-item active" style="width:30px;margin-left:3px;"></li>
                                        <li th:unless="${pageDTO.criteria.getPageNum() == num}" class="page-item active" style="width:30px;margin-left:3px;">
                                            <a style="width:30px" class="page-link" th:href="${num}" th:text="${num}"></a>
                                        </li>
                                    </th:block>

                                    <!--다음 버튼-->
                                    <li><a class="page-link" th:if="*{next}" th:href="*{endPage + 1}">&gt;</a></li>
                                    <!--                                        <li class="page-item" style="width:30px;margin-left:3px;">-->
                                    <!--                                            <a style="width:30px;" class="page-link" href="/freestory/all/date/6/all/?main_genre=">-->
                                    <!--                                                <i class="icon ion-arrow-right-b"></i>-->
                                    <!--                                            </a>-->

                                    <!--                                        </li><li class="page-item" style="width:30px;margin-left:3px;">-->
                                    <!--                                        <a style="width:30px;" class="page-link" href="/freestory/all/date/623/all/?main_genre=">-->
                                    <!--                                            <i class="icon ion-arrow-right-a"></i>-->
                                    <!--                                        </a>-->

                                    </li>
                                    <form action="/myLibrary/payList" th:object="${criteria}" name="pageForm">
                                        <input class="userNumber" type="hidden" name="userNumber" value="1">
                                        <input class="pageNum" type="hidden" th:field="*{pageNum}">

                                        <input class="amount" type="hidden" th:field="*{amount}">
                                    </form>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<th:block th:insert="/fix/footer.html :: footerFragment"/>
</body>
<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/assets/js/mypage/payment.js"></script>
<script src="/assets/js/fix/header.js"></script>
<script th:inline="javascript">
    let pageInfo = [[${criteria.listLink}]];
    const userNumber = [[${session.userNumber}]]; //세션 userNumber



    function money_comma(num){
        num = Number(num);
        num = num.replace(/[^\d]+/g, ''); //숫자만 남김
        return num.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1, ');
    }


    //결제 버튼 눌렀을 때 이동
    // $(".payment").prop('href', '/myLibrary/payList?userNumber=' + userNumber);
    const pageNum = $(".pageNum").val();
    const amount = $(".amount").val();
    // const userNumber = $(".userNumber").val();

    // $(".payment").prop('href', '/myLibrary/payList?userNumber=' + userNumber + "&pageNum=" + pageNum + "&amount=" + amount);

    function goEditProfile(){
        location.href = "/myPage/myPageEditProfile";
    }
    function goMyWork(){
        location.href = "/myPage/myPageMyWork";
    }
    function goChangePw(){
        location.href = "/myPage/myPageChangePw";
    }
    function goQuestion(){
        location.href = "/myPage/myPageQuestion";
    }
    function goQuit(){
        location.href = "/myPage/myPageQuit?userNumber=" + userNumber;
    }
    function goPayList(){
        location.href = "/myLibrary/payList?userNumber=" + userNumber;
    }
</script>
</html>